#!/usr/bin/env php
<?php declare(strict_types = 1);

require_once './vendor/autoload.php';

$path = '.env';
$algo = 'aes256';
$key_path = '.env.key';
$output=$path.'.enc';

try {
    print( "\nSecure Env PHP encryption tool.\n");

    // ENV PATH
    print( "Path to .env file [\x1b[33m.env\x1b[0m]:\n");

    // SECRET KEY
    print( "Path to secret key [\x1b[33m.env.key\x1b[0m]:\n");

    $secret = (new \SecureEnvPHP\Key)->generate($key_path);

    // ENCRYPTION ALGORITHM
    print( "Encryption algorithm [\x1b[33m".$algo."\x1b[0m]:\n");

    // OUTPUT FILE
    print( "Save to [\x1b[33m".$path.".enc\x1b[0m]:\n");

    (new \SecureEnvPHP\Crypto)->encrypt($path, $secret, $algo, $output);

    if (file_exists($output)) {
        print( "\n\x1b[32mFile encryption successful!\x1b[0m\n");
    }
} catch (Exception $e) {
    print( "\x1b[31m[Error]\x1b[0m ".$e->getMessage()."\n");
}
